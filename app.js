const e=require("express"),r=require("path"),n=require("express-handlebars"),s=require("livereload"),t=require("connect-livereload"),i=require("mongoose"),o=(require("dotenv").config(),process.env.MONGO_URI),u=e(),a=i.connection;i.connect(o),a.once("open",(()=>console.log("ConexÃ£o com a base de dados bem sucedida"))),a.on("error",(e=>console.log(e)));const l=require("./routes/homePage"),c=require("./routes/sobrePage"),h=require("./routes/dataPage"),{use:f}=require("./routes/homePage"),d=s.createServer();d.server.once("connection",(()=>{setTimeout((()=>{d.refresh("/")}),100)})),u.use(t()),u.set("views",r.join(__dirname,"views")),u.engine("handlebars",n.engine({defaultLayout:"layout",runtimeOptions:{allowProtoPropertiesByDefault:!0,allowProtoMethodsByDefault:!0}})),u.set("view engine","handlebars");const v=require("handlebars");v.registerHelper("equal",(function(e,r,n){if(e!=r)return n.inverse(this);if(arguments.legth<3)throw new Error("Handlebars compare needs 2 values!");return n.fn(this)})),v.registerHelper("nequal",(function(e,r,n){if(e==r)return n.inverse(this);if(arguments.legth<3)throw new Error("Handlebars compare needs 2 values!");return n.fn(this)})),v.registerHelper("closer",(function(e,r,n){return e-r<=1&&e-r>=0?n.fn(this):n.inverse(this)})),v.registerHelper("close",(function(e,r,n){return e-r>1&&e-r<=2?n.fn(this):n.inverse(this)})),v.registerHelper("far",(function(e,r,n){return e-r>2&&e-r<=5?n.fn(this):n.inverse(this)})),v.registerHelper("further",(function(e,r,n){return e-r>5?n.fn(this):n.inverse(this)})),v.registerHelper("invalid",(function(e,r,n){return e-r<0?n.fn(this):n.inverse(this)})),v.registerHelper("positivo",(function(e,r){return e>0?r.fn(this):r.inverse(this)})),v.registerHelper("negativo",(function(e,r){return e<0?r.fn(this):r.inverse(this)})),u.use(e.json()),u.use(e.urlencoded({extended:!0})),u.use(e.static(r.join(__dirname,"public"))),u.use("/",l),u.use("/data",h),u.use("/sobre",c);const g=process.env.PORT||5e3;u.listen(g,(()=>console.log(`Servidor aberto no port: ${g}`)));